<div class="topbar">
  <div class="left-controls">
    <div class="username-btn">
      <div class="username-progress-bar" [style.width.%]="getProgressPercentage()"></div>
      <div class="username-btn-content">
        <span class="username-text">{{ currentUser?.username }}</span>
        <span class="count-info">{{ (currentUser?.champs?.length || 0) }}/{{ champions.length }}</span>
      </div>
    </div>

    <ion-button
      class="overlay-toggle-btn topbar-btn"
      [class.public]="currentUser?.public"
      [class.private]="!currentUser?.public"
      fill="clear"
      (click)="togglePublicState()"
      [disabled]="isPublicStateSwitching">
      <span class="toggle-text">{{ isPublicStateSwitching ? '...' : (currentUser?.public ? 'Public' : 'Private') }}</span>
    </ion-button>

    <ion-button
      class="overlay-visit-btn topbar-btn"
      *ngIf="currentUser?.public"
      fill="clear"
      (click)="openPublicProfile()"
      title="Open Public Profile">
      üëâ
    </ion-button>

    <div class="search-container">
      <ion-input
        class="search-bar"
        placeholder="Search champions..."
        [(ngModel)]="searchTerm"
        (ionInput)="onSearchChange()">
      </ion-input>
      <button
        class="clear-search-btn"
        (click)="clearSearch()"
        *ngIf="searchTerm">
        ‚úï
      </button>
    </div>

    <div class="filter-buttons">
      <ion-button
        class="filter-button topbar-btn"
        [class.active]="currentFilter === 'all'"
        fill="clear"
        (click)="onFilterChange('all')">
        All
      </ion-button>
      <ion-button
        class="filter-button topbar-btn"
        [class.active]="currentFilter === 'owned'"
        fill="clear"
        (click)="onFilterChange('owned')">
        Checked
      </ion-button>
      <ion-button
        class="filter-button topbar-btn"
        [class.active]="currentFilter === 'unowned'"
        fill="clear"
        (click)="onFilterChange('unowned')">
        Unchecked
      </ion-button>
    </div>
  </div>

  <div class="right-controls">
    <ion-button
      class="github-btn topbar-btn"
      fill="clear"
      href="https://github.com/zlyfer/lolarena"
      target="_blank"
      title="View on GitHub">
      <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
      </svg>
    </ion-button>

    <ion-button
      class="theme-toggle-btn topbar-btn"
      fill="clear"
      (click)="cycleTheme()">
      {{ getThemeButtonText() }}
    </ion-button>

    <ion-button
      class="logout-btn topbar-btn"
      fill="clear"
      (click)="logout()">
      Logout
    </ion-button>
  </div>
</div>

<ion-content class="champion-content">
  <div class="click-button" id="old-version-link">
    <a href="https://oldlolarena.zlyfer.net" target="_blank">
      <span>Old Version</span>
    </a>
  </div>
  <div class="click-button" id="feedback-link">
    <a href="mailto:arenatracker@zlyfer.net?subject=Arena Tracker Feedback">
      <span>Give Feedback</span>
    </a>
  </div>

  <div class="champ-grid">
        <div
      class="champ-card"
      [class.owned]="isChampionOwned(champion)"
      [class.loading]="isChampionLoading(champion)"
      *ngFor="let champion of filteredChampions"
      (click)="toggleChampion(champion)"
      [style.backgroundImage]="'url(' + getChampionImageUrl(champion) + ')'">

      <div class="overlay"></div>
      <div class="loading-spinner"></div>
      <div class="checkmark" *ngIf="isChampionOwned(champion)">‚úì</div>
      <div class="champ-name">{{ champion }}</div>
    </div>
  </div>



  <div class="no-results" *ngIf="filteredChampions.length === 0">
    <p>No champions found matching your search criteria.</p>
  </div>
</ion-content>

<div class="footer">
  <div class="footer-content">
    made with <span class="heart">‚ù§Ô∏è</span> by <a href="https://zlyfer.net" target="_blank" class="footer-link">zlyfer</a>
  </div>
</div>